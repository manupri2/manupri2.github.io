<!DOCTYPE html>
<html lang="en">
<script src="https://d3js.org/d3.v4.js"></script>
<head>
    <meta charset="UTF-8">
    <title>Index Page</title>
</head>
<h1>Narrative Visualization</h1>
<p>I'm hosted with GitHub Pages.</p>
<body>
    <div id="my_dataviz">
    <script>
        var margin = {top: 10, right: 30, bottom: 30, left: 60},
            width = 760 - margin.left - margin.right,
            height = 500 - margin.top - margin.bottom;

        // append the svg object to the body of the page
        var svg = d3.select("#my_dataviz")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform",
                "translate(" + margin.left + "," + margin.top + ")");
        //Read the data
        d3.csv("https://raw.githubusercontent.com/manupri2/manupri2.github.io/master/07-19-2020.csv", function (data) {

            // Add X axis
            var x = d3.scaleLinear()
                .domain([0, 26000])
                .range([0, width]);
            svg.append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x));

            // Add Y axis
            var y = d3.scaleLinear()
                .domain([0, 2000])
                .range([height, 0]);
            svg.append("g")
                .call(d3.axisLeft(y));

            // Color scale: give me a specie name, I return a color
                var color = d3.scaleLinear()
                .domain([0, 2000])
                .range(["#aff05b", "#900c00"]);

            // tooltip mouseover event handler
              var tipMouseover = function(d) {
                  // var color = colorScale(d.Province_State);
                  var html  = d.Province_State + "<br/>" +
                              "<span>" + d.Province_State + "</span><br/>" +
                              "<b>" + d.Incident_Rate + "</b> Incident_Rate, <b/>" + d.Testing_Rate + "</b> Testing_Rate";

                  tooltip.html(html)
                      .style("left", (d3.event.pageX + 15) + "px")
                      .style("top", (d3.event.pageY - 28) + "px")
                    .transition()
                      .duration(200) // ms
                      .style("opacity", .9) // started as 0!

              };
              // tooltip mouseout event handler
              var tipMouseout = function(d) {
                  tooltip.transition()
                      .duration(300) // ms
                      .style("opacity", 0); // don't care about position!
              };

            // Add dots
            svg.append('g')
                .selectAll("dot")
                .data(data)
                .enter()
                .append("circle")
                .attr("cx", function (d) {
                    return x(d.Testing_Rate);
                })
                .attr("cy", function (d) {
                    return y(d.Incident_Rate);
                })
                .attr("r", 5)
                .style('fill', function(d) {
                    return color(d.Incident_Rate);
                })
                .on("mouseover", tipMouseover)
                .on("mouseout", tipMouseout);
            // svg.selectAll("text")
            //     .data(data).enter()
            //     .append("text")
            //     .attr("x", function (d) {
            //         return x(d.Testing_Rate)-5;
            //     })
            //     .attr("y", function (d) {
            //         return y(d.Incident_Rate)-10;
            //     })
            //     .text(function(d) {return d.Province_State})
            //     .attr("font-size", "10px")
        })

    </script>
</div>

</body>
</html>
